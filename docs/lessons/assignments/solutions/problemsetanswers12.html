<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Week 17 Problem Set Solutions &#8212; CoderGirl  documentation</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/launchcode.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Lesson 18: Indexing" href="../../lesson18.html" />
    <link rel="prev" title="Week 17 Problem Set" href="../problemset12.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><span><img src="../../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
          CoderGirl SQL</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Lessons <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ol class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lesson01.html">Lesson 1: Ice breakers and database introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson02.html">Lesson 2: Writing SELECT Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson03.html">Lesson 3: Database Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson04.html">Lesson 4: Filtering and Ordering Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson05.html">Lesson 5: Introduction to SQL Server Reporting Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson06.html">Lesson 6: Using Parameters in Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson07.html">Lesson 7: Advanced Report Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson08.html">Lesson 8: Joining Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson09.html">Lesson 9: UNION and IN Subqueries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson10.html">Lesson 10: Scalar Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson11.html">Lesson 11: Aggregate Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson12.html">Lesson 12: Grouping in Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson13.html">Lesson 13: Deploying SSRS Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson14.html">Lesson 14: Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson15.html">Lesson 15: Creating Tables and Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson16.html">Lesson 16: Modifying Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../lesson17.html">Lesson 17: Stored Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson18.html">Lesson 18: Indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson19.html">Lesson 19: Advanced Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lesson20.html">Lesson 20: Using Report Builder and Report Parts</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../resources/sql_server_install.html">SQL Server Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/connection_issues.html">Connection Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/how_to_restore_a_database.html">How to Restore a Database</a></li>
</ol>
<ol class="current">
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers02.html">Week 2 Problem Set Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers03.html">Week 3 Problem Set Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers04.html">Week 4 Problem Set Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers05.html">Week 8 Problem Set Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers06.html">Week 9 Problem Set Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers07.html">Week 10 Problem Set Part 1 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers08.html">Week 10 Problem Set Part 2 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers09.html">Week 12 Problem Set Part 1 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers10.html">Week 12 Problem Set Part 2 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="problemsetanswers11.html">Week 16 Problem Set Solutions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Week 17 Problem Set Solutions</a></li>
</ol>
<ol>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About this Curriculum</a></li>
</ol>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Week 17 Problem Set Solutions</a><ul>
<li><a class="reference internal" href="#exercise-1">Exercise 1</a></li>
<li><a class="reference internal" href="#exercise-2">Exercise 2</a></li>
<li><a class="reference internal" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="week-17-problem-set-solutions">
<span id="week-17-problem-set-solutions"></span><h1>Week 17 Problem Set Solutions<a class="headerlink" href="#week-17-problem-set-solutions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-1">
<span id="exercise-1"></span><h2>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">Create a copy of the Sales.SalesOrderHeader table into a temp table called #Sales and populate it with data in one step. Include only the SalesOrderID, OrderDate, TotalDue, and CustomerID columns.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> SELECT SalesOrderID, OrderDate, TotalDue, CustomerID INTO #Sales FROM
 Sales.SalesOrderHeader;
</pre></div>
</div>
</li>
<li><p class="first">Create a temp table called #Customers. It must have a CustomerID. It must also have a FirstName and LastName column. Figure out which data types are needed by looking at the Person.Person and Sales.Customer tables. Make the CustomerID a primary key.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> CREATE TABLE #Customers (
 CustomerID INT PRIMARY KEY,
 FirstName NVARCHAR(50),
 LastName NVARCHAR(50)
 );
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="exercise-2">
<span id="exercise-2"></span><h2>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">Write a query to populate the #Customers table. You will need to join the Person.Person and Sales.Customer tables. The PersonID will join to the BusinessEntityID. Be sure to run the query to populate the #Customers table.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> INSERT INTO #Customers (CustomerID, FirstName, LastName)
 SELECT C.CustomerID, P.FirstName, P.LastName
 FROM Sales.Customer AS C JOIN Person.Person AS P ON P.BusinessEntityID = C.PersonID;
</pre></div>
</div>
</li>
<li><p class="first">Add three new customers to the #Customers table. They can be any names you wish, but make sure that you do not duplicate the CustomerID column.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> SELECT MAX(CustomerID) AS MaxCustomerID FROM #Customers;
 --Answers will vary!
 INSERT INTO #Customers ( CustomerID, FirstName, LastName )
 VALUES (30119, &#39;Kathi&#39;,&#39;Morgan&#39;),
  (30120,&#39;Charlie&#39;,&#39;Brown&#39;),
  (30121, &#39;Snoopy&#39;,&#39;Brown&#39;);
</pre></div>
</div>
</li>
<li><p class="first">Add an order for each of the new customers you added in 2.2. Make sure you do not duplicate existing SalesOrderID values. You can choose any date and total due you wish.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> SELECT MAX(SalesOrderID) AS MaxSalesOrderID FROM #Sales;
 --Answers will vary
 INSERT INTO #Sales( SalesOrderID, OrderDate, TotalDue, CustomerID)
 VALUES (75124,&#39;2015-08-31&#39;,100,30119),
  (75125,&#39;2015-09-01&#39;,200,30120),
  (75126,&#39;2015-09-02&#39;,300,30121);
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="exercise-3">
<span id="exercise-3"></span><h2>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">Modify the #Sales rows so that every order below $10 is changed to $10.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> UPDATE #Sales
 SET TotalDue = 10
 WHERE TotalDue &lt; 10;
</pre></div>
</div>
</li>
<li><p class="first">You can also use existing columns to modify data. Write a query that adds one day to every OrderDate in the #Sales table. Use the DATEADD function.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> UPDATE #Sales
 SET OrderDate = DATEADD(DAY, 1, OrderDate);
</pre></div>
</div>
</li>
<li><p class="first">Delete any rows where the order was placed in 2011.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> DELETE FROM #Sales
 WHERE OrderDate &gt;= &#39;2011-01-01&#39; AND OrderDate &lt; &#39;2012-01-01&#39;;
</pre></div>
</div>
</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../../_sources/lessons/assignments/solutions/problemsetanswers12.md.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>